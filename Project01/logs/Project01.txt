2024-05-21 16:19:29.220 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-21 16:19:29.352 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-21 16:19:29.353 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-21 16:19:29.353 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-21 16:19:29.354 +05:00 [INF] Hosting environment: Development
2024-05-21 16:19:29.354 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-21 16:19:30.025 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-21 16:19:30.221 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 199.1871ms
2024-05-21 16:19:30.247 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-21 16:19:30.251 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-21 16:19:30.266 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 18.8124ms
2024-05-21 16:19:30.291 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 39.9708ms
2024-05-21 16:19:30.352 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-21 16:19:30.439 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 86.6974ms
2024-05-22 14:11:35.702 +05:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-22 14:11:35.738 +05:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-22 14:11:35.741 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-22 14:11:35.742 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-22 14:11:35.777 +05:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-22 14:11:35.792 +05:00 [INF] Applying migration '20240522091124_employee'.
2024-05-22 14:11:35.846 +05:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Employees] (
    [Id] int NOT NULL IDENTITY,
    [FirstName] nvarchar(max) NOT NULL,
    [LastName] nvarchar(max) NOT NULL,
    [Cnic] nvarchar(max) NOT NULL,
    [Created] datetime2 NOT NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [Ended] datetime2 NOT NULL,
    [EndedBy] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Employees] PRIMARY KEY ([Id])
);
2024-05-22 14:11:35.851 +05:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240522091124_employee', N'7.0.19');
2024-05-22 14:24:19.485 +05:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-22 14:24:19.511 +05:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-22 14:24:19.513 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2024-05-22 14:24:19.514 +05:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2024-05-22 14:24:19.536 +05:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2024-05-22 14:24:19.545 +05:00 [INF] Applying migration '20240522092409_employee1'.
2024-05-22 14:24:19.665 +05:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Employees]') AND [c].[name] = N'EndedBy');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Employees] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Employees] ALTER COLUMN [EndedBy] nvarchar(max) NULL;
2024-05-22 14:24:19.695 +05:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Employees]') AND [c].[name] = N'Ended');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [Employees] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [Employees] ALTER COLUMN [Ended] datetime2 NULL;
2024-05-22 14:24:19.727 +05:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Employees]') AND [c].[name] = N'CreatedBy');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Employees] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Employees] ALTER COLUMN [CreatedBy] nvarchar(max) NULL;
2024-05-22 14:24:19.757 +05:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Employees]') AND [c].[name] = N'Created');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Employees] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Employees] ALTER COLUMN [Created] datetime2 NULL;
2024-05-22 14:24:19.760 +05:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20240522092409_employee1', N'7.0.19');
2024-05-22 14:35:11.055 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-22 14:35:11.783 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-22 14:35:11.784 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-22 14:35:11.785 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-22 14:35:11.785 +05:00 [INF] Hosting environment: Development
2024-05-22 14:35:11.786 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-22 14:35:12.949 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 14:35:13.518 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 574.4687ms
2024-05-22 14:35:13.563 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 14:35:13.569 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 14:35:13.589 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 25.3077ms
2024-05-22 14:35:13.710 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 140.6788ms
2024-05-22 14:35:14.070 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 14:35:14.228 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 157.8370ms
2024-05-22 14:35:32.914 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 14:35:32.968 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 54.2942ms
2024-05-22 14:35:33.002 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 14:35:33.002 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 14:35:33.004 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 2.8841ms
2024-05-22 14:35:33.062 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 59.6997ms
2024-05-22 14:35:33.163 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 14:35:33.232 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 69.0297ms
2024-05-22 14:39:39.245 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-22 14:39:39.417 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-22 14:39:39.417 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-22 14:39:39.418 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-22 14:39:39.418 +05:00 [INF] Hosting environment: Development
2024-05-22 14:39:39.418 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-22 14:39:39.939 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 14:39:40.245 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 309.0169ms
2024-05-22 14:39:40.278 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 14:39:40.287 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 14:39:40.294 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 16.2959ms
2024-05-22 14:39:40.341 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 54.2396ms
2024-05-22 14:39:40.420 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 14:39:40.536 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 116.0425ms
2024-05-22 14:41:01.519 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:41:01.893 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:41:01.974 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:41:01.989 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployee (Project01) in 6.174ms
2024-05-22 14:41:02.003 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:41:02.263 +05:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'Project01.Services.Employees.IEmployeeBusinessLogic' while attempting to activate 'Project01.Services.Employees.EmployeeController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetService(IServiceProvider sp, Type type, Type requiredBy, Boolean isDefaultParameterRequired)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:41:02.341 +05:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:41:02.355 +05:00 [ERR] Connection id "0HN3Q8CCTKU8C", Request id "0HN3Q8CCTKU8C:00000009": An unhandled exception was thrown by the application.
System.InvalidOperationException: Unable to resolve service for type 'Project01.Services.Employees.IEmployeeBusinessLogic' while attempting to activate 'Project01.Services.Employees.EmployeeController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetService(IServiceProvider sp, Type type, Type requiredBy, Boolean isDefaultParameterRequired)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2024-05-22 14:41:02.360 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101 - 500 0 - 841.7862ms
2024-05-22 14:41:22.178 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:41:22.218 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:41:22.220 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:41:22.221 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployee (Project01) in 1.1735ms
2024-05-22 14:41:22.222 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:41:22.338 +05:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'Project01.Services.Employees.IEmployeeBusinessLogic' while attempting to activate 'Project01.Services.Employees.EmployeeController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetService(IServiceProvider sp, Type type, Type requiredBy, Boolean isDefaultParameterRequired)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:41:22.342 +05:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:41:22.344 +05:00 [ERR] Connection id "0HN3Q8CCTKU8C", Request id "0HN3Q8CCTKU8C:0000000B": An unhandled exception was thrown by the application.
System.InvalidOperationException: Unable to resolve service for type 'Project01.Services.Employees.IEmployeeBusinessLogic' while attempting to activate 'Project01.Services.Employees.EmployeeController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.GetService(IServiceProvider sp, Type type, Type requiredBy, Boolean isDefaultParameterRequired)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2024-05-22 14:41:22.345 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101 - 500 0 - 166.9333ms
2024-05-22 14:42:06.449 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-22 14:42:06.666 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-22 14:42:06.666 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-22 14:42:06.668 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-22 14:42:06.668 +05:00 [INF] Hosting environment: Development
2024-05-22 14:42:06.668 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-22 14:42:07.521 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 14:42:07.832 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 316.2177ms
2024-05-22 14:42:07.862 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 14:42:07.867 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 5.5577ms
2024-05-22 14:42:07.868 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 14:42:07.916 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 48.3099ms
2024-05-22 14:42:08.019 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 14:42:08.147 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 128.4622ms
2024-05-22 14:42:15.752 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:42:15.969 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:42:16.023 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:42:16.593 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01) - Validation state: "Valid"
2024-05-22 14:42:40.600 +05:00 [INF] Executed action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 23987.9167ms.
2024-05-22 14:42:40.640 +05:00 [INF] Executing OkObjectResult, writing value of type 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[[Project01.DTOs.AppResponse, Project01, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[Project01.Services.Employees.EmployeeBusinessLogic+<AddEmployee>d__2, Project01, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-05-22 14:42:40.789 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployee (Project01) in 24754.6961ms
2024-05-22 14:42:40.792 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:42:40.888 +05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported. Path: $.MoveNextAction.
 ---> System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported.
   at System.Text.Json.Serialization.Converters.UnsupportedTypeConverter`1.Write(Utf8JsonWriter writer, T value, JsonSerializerOptions options)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ThrowNotSupportedException(WriteStack& state, NotSupportedException ex)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCoreAsObject(Utf8JsonWriter writer, Object value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteCore[TValue](Utf8JsonWriter writer, TValue& value, JsonTypeInfo jsonTypeInfo, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeResultAsync>g__Logged|22_0(ResourceInvoker invoker, IActionResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:42:40.922 +05:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:42:40.926 +05:00 [ERR] Connection id "0HN3Q8DOTM8NJ", Request id "0HN3Q8DOTM8NJ:00000009": An unhandled exception was thrown by the application.
System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported. Path: $.MoveNextAction.
 ---> System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported.
   at System.Text.Json.Serialization.Converters.UnsupportedTypeConverter`1.Write(Utf8JsonWriter writer, T value, JsonSerializerOptions options)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ThrowNotSupportedException(WriteStack& state, NotSupportedException ex)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCoreAsObject(Utf8JsonWriter writer, Object value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteCore[TValue](Utf8JsonWriter writer, TValue& value, JsonTypeInfo jsonTypeInfo, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeResultAsync>g__Logged|22_0(ResourceInvoker invoker, IActionResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2024-05-22 14:42:40.950 +05:00 [ERR] An error occurred using the connection to database 'DB_Project01' on server 'AK-SWL-0272'.
2024-05-22 14:42:41.053 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101 - 500 0 - 25302.0484ms
2024-05-22 14:42:48.742 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:42:48.767 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:42:48.767 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:42:48.795 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01) - Validation state: "Valid"
2024-05-22 14:43:01.967 +05:00 [INF] Executed action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 13172.1546ms.
2024-05-22 14:43:01.968 +05:00 [INF] Executing OkObjectResult, writing value of type 'System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1+AsyncStateMachineBox`1[[Project01.DTOs.AppResponse, Project01, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null],[System.Runtime.CompilerServices.IAsyncStateMachine, System.Private.CoreLib, Version=7.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2024-05-22 14:43:01.977 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployee (Project01) in 13209.8371ms
2024-05-22 14:43:01.978 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:43:02.027 +05:00 [ERR] An unhandled exception has occurred while executing the request.
System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported. Path: $.MoveNextAction.
 ---> System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported.
   at System.Text.Json.Serialization.Converters.UnsupportedTypeConverter`1.Write(Utf8JsonWriter writer, T value, JsonSerializerOptions options)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ThrowNotSupportedException(WriteStack& state, NotSupportedException ex)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCoreAsObject(Utf8JsonWriter writer, Object value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteCore[TValue](Utf8JsonWriter writer, TValue& value, JsonTypeInfo jsonTypeInfo, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeResultAsync>g__Logged|22_0(ResourceInvoker invoker, IActionResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:43:02.034 +05:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 14:43:02.036 +05:00 [ERR] Connection id "0HN3Q8DOTM8NJ", Request id "0HN3Q8DOTM8NJ:0000000B": An unhandled exception was thrown by the application.
System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported. Path: $.MoveNextAction.
 ---> System.NotSupportedException: Serialization and deserialization of 'System.Action' instances are not supported.
   at System.Text.Json.Serialization.Converters.UnsupportedTypeConverter`1.Write(Utf8JsonWriter writer, T value, JsonSerializerOptions options)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   --- End of inner exception stack trace ---
   at System.Text.Json.ThrowHelper.ThrowNotSupportedException(WriteStack& state, NotSupportedException ex)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCoreAsObject(Utf8JsonWriter writer, Object value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteCore[TValue](Utf8JsonWriter writer, TValue& value, JsonTypeInfo jsonTypeInfo, WriteStack& state)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at System.Text.Json.JsonSerializer.WriteStreamAsync[TValue](Stream utf8Json, TValue value, JsonTypeInfo jsonTypeInfo, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter.WriteResponseBodyAsync(OutputFormatterWriteContext context, Encoding selectedEncoding)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeResultAsync>g__Logged|22_0(ResourceInvoker invoker, IActionResult result)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\TokenValidationMiddleware.cs:line 33
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context) in C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01\Middlewares\RequestResponseLoggingMiddleware.cs:line 31
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2024-05-22 14:43:02.056 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101 - 500 0 - 13314.9323ms
2024-05-22 14:43:02.075 +05:00 [INF] Executed DbCommand (181ms) [Parameters=[@__model_Cnic_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Cnic], [e].[Created], [e].[CreatedBy], [e].[Ended], [e].[EndedBy], [e].[FirstName], [e].[LastName]
FROM [Employees] AS [e]
WHERE [e].[Cnic] = @__model_Cnic_0 AND ([e].[Ended] IS NULL)
2024-05-22 14:43:02.162 +05:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Project01.Context.AppDbContext'.
System.ObjectDisposedException: Cannot access a disposed context instance. A common cause of this error is disposing a context instance that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling 'Dispose' on the context instance, or wrapping it in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances.
Object name: 'AppDbContext'.
   at Microsoft.EntityFrameworkCore.DbContext.CheckDisposed()
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Internal.IDbContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContext.InitializeStateManager(Boolean standAlone)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.ObjectDisposedException: Cannot access a disposed context instance. A common cause of this error is disposing a context instance that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling 'Dispose' on the context instance, or wrapping it in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances.
Object name: 'AppDbContext'.
   at Microsoft.EntityFrameworkCore.DbContext.CheckDisposed()
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.Microsoft.EntityFrameworkCore.Internal.IDbContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContextDependencies.get_StateManager()
   at Microsoft.EntityFrameworkCore.Query.QueryContext.InitializeStateManager(Boolean standAlone)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.InitializeReaderAsync(AsyncEnumerator enumerator, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2024-05-22 14:46:10.011 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:46:10.068 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:46:10.068 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:46:10.090 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01) - Validation state: "Valid"
2024-05-22 14:46:31.054 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-22 14:46:31.253 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-22 14:46:31.253 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-22 14:46:31.254 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-22 14:46:31.254 +05:00 [INF] Hosting environment: Development
2024-05-22 14:46:31.254 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-22 14:46:31.893 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 14:46:32.199 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 310.1376ms
2024-05-22 14:46:32.232 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 14:46:32.236 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 4.0779ms
2024-05-22 14:46:32.242 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 14:46:32.293 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 51.2616ms
2024-05-22 14:46:32.381 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 14:46:32.529 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 148.7650ms
2024-05-22 14:46:55.301 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:46:55.529 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:46:55.579 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:46:56.106 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01) - Validation state: "Valid"
2024-05-22 14:47:02.826 +05:00 [INF] Executed DbCommand (107ms) [Parameters=[@__model_Cnic_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Cnic], [e].[Created], [e].[CreatedBy], [e].[Ended], [e].[EndedBy], [e].[FirstName], [e].[LastName]
FROM [Employees] AS [e]
WHERE [e].[Cnic] = @__model_Cnic_0 AND ([e].[Ended] IS NULL)
2024-05-22 14:47:19.868 +05:00 [INF] Executed DbCommand (72ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Employees] ([Cnic], [Created], [CreatedBy], [Ended], [EndedBy], [FirstName], [LastName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2024-05-22 14:47:26.503 +05:00 [INF] Executed action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 30385.3941ms.
2024-05-22 14:47:26.520 +05:00 [INF] Executing OkObjectResult, writing value of type 'Project01.DTOs.AppResponse'.
2024-05-22 14:47:26.538 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployee (Project01) in 30951.6918ms
2024-05-22 14:47:26.539 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:47:26.561 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101 - 200 - application/json;+charset=utf-8 31271.0160ms
2024-05-22 14:47:47.329 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101
2024-05-22 14:47:47.352 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:47:47.354 +05:00 [INF] Route matched with {action = "AddEmployee", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployee(Project01.DTOs.EmployeeDTO) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 14:47:47.391 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01) - Validation state: "Valid"
2024-05-22 14:47:50.261 +05:00 [INF] Executed DbCommand (25ms) [Parameters=[@__model_Cnic_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Cnic], [e].[Created], [e].[CreatedBy], [e].[Ended], [e].[EndedBy], [e].[FirstName], [e].[LastName]
FROM [Employees] AS [e]
WHERE [e].[Cnic] = @__model_Cnic_0 AND ([e].[Ended] IS NULL)
2024-05-22 14:47:50.275 +05:00 [INF] Executed action method Project01.Services.Employees.EmployeeController.AddEmployee (Project01), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 2884.0618ms.
2024-05-22 14:47:50.277 +05:00 [INF] Executing OkObjectResult, writing value of type 'Project01.DTOs.AppResponse'.
2024-05-22 14:47:50.278 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployee (Project01) in 2923.5265ms
2024-05-22 14:47:50.278 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployee (Project01)'
2024-05-22 14:47:50.279 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployee application/json 101 - 200 - application/json;+charset=utf-8 2949.9908ms
2024-05-22 16:13:21.167 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-22 16:13:21.388 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-22 16:13:21.388 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-22 16:13:21.389 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-22 16:13:21.389 +05:00 [INF] Hosting environment: Development
2024-05-22 16:13:21.389 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-22 16:13:22.279 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 16:13:22.530 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 255.5237ms
2024-05-22 16:13:22.569 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 16:13:22.573 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 3.8984ms
2024-05-22 16:13:22.580 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 16:13:22.614 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 33.7285ms
2024-05-22 16:13:22.680 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 16:13:22.756 +05:00 [ERR] An unhandled exception has occurred while executing the request.
Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Conflicting method/path combination "POST api/Employee/addEmployee" for actions - Project01.Services.Employees.EmployeeController.AddEmployee (Project01),Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01). Actions require a unique method/path combination for Swagger/OpenAPI 3.0. Use ConflictingActionsResolver as a workaround
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperations(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GeneratePaths(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GetSwaggerDocumentWithoutFilters(String documentName, String host, String basePath)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GetSwaggerAsync(String documentName, String host, String basePath)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 16:13:22.784 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 500 - text/plain;+charset=utf-8 103.8034ms
2024-05-22 16:13:37.297 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 16:13:37.323 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 26.3762ms
2024-05-22 16:13:37.341 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 16:13:37.342 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 16:13:37.343 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 1.7897ms
2024-05-22 16:13:37.377 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 34.8712ms
2024-05-22 16:13:37.406 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 16:13:37.476 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 70.0514ms
2024-05-22 16:14:08.202 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryExZtQk288ob06K5F 9142
2024-05-22 16:14:08.347 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01)'
2024-05-22 16:14:08.380 +05:00 [INF] Route matched with {action = "AddEmployeeInBulk", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployeeInBulk(Microsoft.AspNetCore.Http.IFormFile) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 16:14:08.611 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01) - Validation state: "Valid"
2024-05-22 16:14:15.322 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01) in 6938.8076ms
2024-05-22 16:14:15.333 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01)'
2024-05-22 16:14:18.742 +05:00 [ERR] An unhandled exception has occurred while executing the request.
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Project01.Services.Employees.EmployeeBusinessLogic.AddEmployeeInBulk(IFormFile file)
   at Project01.Services.Employees.EmployeeController.AddEmployeeInBulk(IFormFile file)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.FileValidationMiddleware.Invoke(HttpContext context)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 16:14:18.754 +05:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 16:14:18.770 +05:00 [ERR] Connection id "0HN3QA0OF2P4H", Request id "0HN3QA0OF2P4H:00000011": An unhandled exception was thrown by the application.
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Project01.Services.Employees.EmployeeBusinessLogic.AddEmployeeInBulk(IFormFile file)
   at Project01.Services.Employees.EmployeeController.AddEmployeeInBulk(IFormFile file)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.FileValidationMiddleware.Invoke(HttpContext context)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2024-05-22 16:14:18.774 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryExZtQk288ob06K5F 9142 - 500 0 - 10572.4105ms
2024-05-22 16:14:55.446 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryuJ0rDqnMYnUyRkis 9142
2024-05-22 16:14:55.506 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01)'
2024-05-22 16:14:55.506 +05:00 [INF] Route matched with {action = "AddEmployeeInBulk", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployeeInBulk(Microsoft.AspNetCore.Http.IFormFile) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 16:14:55.537 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01) - Validation state: "Valid"
2024-05-22 16:15:42.687 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01) in 47180.0187ms
2024-05-22 16:15:42.687 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01)'
2024-05-22 16:15:42.756 +05:00 [ERR] An unhandled exception has occurred while executing the request.
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Project01.Services.Employees.EmployeeBusinessLogic.AddEmployeeInBulk(IFormFile file)
   at Project01.Services.Employees.EmployeeController.AddEmployeeInBulk(IFormFile file)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.FileValidationMiddleware.Invoke(HttpContext context)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 16:15:42.758 +05:00 [ERR] An exception was thrown attempting to display the error page.
System.ObjectDisposedException: Cannot access a closed Stream.
   at System.IO.MemoryStream.Write(Byte[] buffer, Int32 offset, Int32 count)
   at System.IO.MemoryStream.WriteAsync(ReadOnlyMemory`1 buffer, CancellationToken cancellationToken)
--- End of stack trace from previous location ---
   at System.IO.Pipelines.StreamPipeWriter.FlushAsyncInternal(Boolean writeToStream, ReadOnlyMemory`1 data, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.GetTaskForValueTaskSource(IValueTaskSource`1 t)
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.DisplayExceptionContent(ErrorContext errorContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2024-05-22 16:15:42.759 +05:00 [ERR] Connection id "0HN3QA0OF2P4H", Request id "0HN3QA0OF2P4H:00000013": An unhandled exception was thrown by the application.
OfficeOpenXml.LicenseException: Please set the ExcelPackage.LicenseContext property. See https://epplussoftware.com/developers/licenseexception
   at OfficeOpenXml.ExcelPackage.get_Workbook()
   at Project01.Services.Employees.EmployeeBusinessLogic.AddEmployeeInBulk(IFormFile file)
   at Project01.Services.Employees.EmployeeController.AddEmployeeInBulk(IFormFile file)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Project01.Middlewares.FileValidationMiddleware.Invoke(HttpContext context)
   at Project01.Middlewares.TokenValidationMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at RequestResponseLoggingMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2024-05-22 16:15:42.759 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryuJ0rDqnMYnUyRkis 9142 - 500 0 - 47313.5993ms
2024-05-22 16:17:42.205 +05:00 [INF] User profile is available. Using 'C:\Users\shanawar.zaheer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-05-22 16:17:42.398 +05:00 [INF] Now listening on: https://localhost:7144
2024-05-22 16:17:42.398 +05:00 [INF] Now listening on: http://localhost:5265
2024-05-22 16:17:42.400 +05:00 [INF] Application started. Press Ctrl+C to shut down.
2024-05-22 16:17:42.400 +05:00 [INF] Hosting environment: Development
2024-05-22 16:17:42.400 +05:00 [INF] Content root path: C:\Users\shanawar.zaheer\Desktop\Identity\Project01\Project01
2024-05-22 16:17:42.852 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/index.html - -
2024-05-22 16:17:43.130 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/index.html - - - 200 - text/html;charset=utf-8 280.5944ms
2024-05-22 16:17:43.159 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - -
2024-05-22 16:17:43.164 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/_vs/browserLink - -
2024-05-22 16:17:43.167 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_framework/aspnetcore-browser-refresh.js - - - 200 11988 application/javascript;+charset=utf-8 7.7758ms
2024-05-22 16:17:43.206 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 41.2107ms
2024-05-22 16:17:43.268 +05:00 [INF] Request starting HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - -
2024-05-22 16:17:43.370 +05:00 [INF] Request finished HTTP/2 GET https://localhost:7144/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 101.8401ms
2024-05-22 16:17:54.811 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryDqLxn5egoOQtA6Qt 9142
2024-05-22 16:17:54.968 +05:00 [INF] Executing endpoint 'Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01)'
2024-05-22 16:17:54.994 +05:00 [INF] Route matched with {action = "AddEmployeeInBulk", controller = "Employee"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddEmployeeInBulk(Microsoft.AspNetCore.Http.IFormFile) on controller Project01.Services.Employees.EmployeeController (Project01).
2024-05-22 16:17:55.222 +05:00 [INF] Executing action method Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01) - Validation state: "Valid"
2024-05-22 16:18:28.362 +05:00 [INF] Executed DbCommand (153ms) [Parameters=[@__item_Cnic_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Cnic], [e].[Created], [e].[CreatedBy], [e].[Ended], [e].[EndedBy], [e].[FirstName], [e].[LastName]
FROM [Employees] AS [e]
WHERE [e].[Cnic] = @__item_Cnic_0 AND ([e].[Ended] IS NULL)
2024-05-22 16:18:32.697 +05:00 [INF] Executed DbCommand (41ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Employees] ([Cnic], [Created], [CreatedBy], [Ended], [EndedBy], [FirstName], [LastName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2024-05-22 16:18:42.305 +05:00 [INF] Executed DbCommand (15ms) [Parameters=[@__item_Cnic_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Cnic], [e].[Created], [e].[CreatedBy], [e].[Ended], [e].[EndedBy], [e].[FirstName], [e].[LastName]
FROM [Employees] AS [e]
WHERE [e].[Cnic] = @__item_Cnic_0 AND ([e].[Ended] IS NULL)
2024-05-22 16:18:46.516 +05:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Employees] ([Cnic], [Created], [CreatedBy], [Ended], [EndedBy], [FirstName], [LastName])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2024-05-22 16:19:04.657 +05:00 [INF] Executed action method Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 69429.941ms.
2024-05-22 16:19:04.663 +05:00 [INF] Executing OkObjectResult, writing value of type 'Project01.DTOs.AppResponse'.
2024-05-22 16:19:04.726 +05:00 [INF] Executed action Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01) in 69728.0027ms
2024-05-22 16:19:04.726 +05:00 [INF] Executed endpoint 'Project01.Services.Employees.EmployeeController.AddEmployeeInBulk (Project01)'
2024-05-22 16:19:04.748 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryDqLxn5egoOQtA6Qt 9142 - 200 - application/json;+charset=utf-8 69937.0447ms
2024-05-22 16:20:39.655 +05:00 [INF] Request starting HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryS8L08RrQDT9ivv3F 1513
2024-05-22 16:20:39.700 +05:00 [INF] Request finished HTTP/2 POST https://localhost:7144/api/Employee/addEmployeeInBulk multipart/form-data;+boundary=----WebKitFormBoundaryS8L08RrQDT9ivv3F 1513 - 415 - - 44.1905ms
